"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},asyncGenerator=function(){function e(e){this.value=e}function t(t){var r,n;function o(r,n){try{var a=t[r](n),u=a.value;u instanceof e?Promise.resolve(u.value).then(function(e){o("next",e)},function(e){o("throw",e)}):i(a.done?"return":"normal",a.value)}catch(e){i("throw",e)}}function i(e,t){switch(e){case"return":r.resolve({value:t,done:!0});break;case"throw":r.reject(t);break;default:r.resolve({value:t,done:!1})}(r=r.next)?o(r.key,r.arg):n=null}this._invoke=function(e,t){return new Promise(function(i,a){var u={key:e,arg:t,resolve:i,reject:a,next:null};n?n=n.next=u:(r=n=u,o(e,t))})},"function"!=typeof t.return&&(this.return=void 0)}return"function"==typeof Symbol&&Symbol.asyncIterator&&(t.prototype[Symbol.asyncIterator]=function(){return this}),t.prototype.next=function(e){return this._invoke("next",e)},t.prototype.throw=function(e){return this._invoke("throw",e)},t.prototype.return=function(e){return this._invoke("return",e)},{wrap:function(e){return function(){return new t(e.apply(this,arguments))}},await:function(t){return new e(t)}}}(),slicedToArray=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{!n&&u.return&&u.return()}finally{if(o)throw i}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_marked=regeneratorRuntime.mark(entries);function ajax(e){return new Promise(function(t,r){if(!e.method)return console.error("method is required. ex. method: 'post'");e.headers||(e.headers={"Content-type":"application/x-www-form-urlencoded; charset=UTF-8"}),e.credentials||(e.credentials="same-origin");var n=e.url||BIA.AJAX_URL;if(e.body){var o="object"==_typeof(e.body)?deepSerialize(e.body):e.body,i=e.method.toLowerCase();"post"===i?"FormData"===e.body.constructor.name?e.headers={}:e.body=o:"get"===i&&(delete e.body,n.includes("?")?n+=n.endsWith("&")||n.endsWith("?")?"":"&":0!==o.indexOf("?")&&(n+="?"),n+=o)}fetch(n,e).then(function(e){var n=e.headers.get("content-type"),o=function(e){return-1!==n.indexOf(e)};e.ok&&n?o("application/json")?t(e.json()):o("text/")?t(e.text()):o("form-data")?t(e.formData()):o("image/")?t(e.blob()):o("audio/")||o("video/")||o("application/ogg")?t(e.arrayBuffer()):t(e):(console.log("ajax response not ok: ",e),r(e))}).catch(function(e){console.log("ajax catch: ",e),r(e)})})}function entries(e){var t,r,n,o,i,a;return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:t=!0,r=!1,n=void 0,u.prev=3,o=Object.keys(e)[Symbol.iterator]();case 5:if(t=(i=o.next()).done){u.next=12;break}return a=i.value,u.next=9,[a,e[a]];case 9:t=!0,u.next=5;break;case 12:u.next=18;break;case 14:u.prev=14,u.t0=u.catch(3),r=!0,n=u.t0;case 18:u.prev=18,u.prev=19,!t&&o.return&&o.return();case 21:if(u.prev=21,!r){u.next=24;break}throw n;case 24:return u.finish(21);case 25:return u.finish(18);case 26:case"end":return u.stop()}},_marked,this,[[3,14,18,26],[19,,21,25]])}function deepSerialize(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(!e||"function"==typeof e)return""!=t?t+"=null":"";var r=[];if(e instanceof Object){var n=!0,o=!1,i=void 0;try{for(var a,u=entries(e)[Symbol.iterator]();!(n=(a=u.next()).done);n=!0){var c=a.value,s=slicedToArray(c,2),f=s[0],l=s[1];"string"!=typeof l&&"object"!=(void 0===l?"undefined":_typeof(l))||r.push(deepSerialize(l,""!==t?t+"["+f+"]":f))}}catch(e){o=!0,i=e}finally{try{!n&&u.return&&u.return()}finally{if(o)throw i}}return r.join("&")}return"string"==typeof e?t+"="+e:void 0}module.exports=ajax;
