"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},asyncGenerator=function(){function e(e){this.value=e}function t(t){var o,n;function r(o,n){try{var a=t[o](n),u=a.value;u instanceof e?Promise.resolve(u.value).then(function(e){r("next",e)},function(e){r("throw",e)}):i(a.done?"return":"normal",a.value)}catch(e){i("throw",e)}}function i(e,t){switch(e){case"return":o.resolve({value:t,done:!0});break;case"throw":o.reject(t);break;default:o.resolve({value:t,done:!1})}(o=o.next)?r(o.key,o.arg):n=null}this._invoke=function(e,t){return new Promise(function(i,a){var u={key:e,arg:t,resolve:i,reject:a,next:null};n?n=n.next=u:(o=n=u,r(e,t))})},"function"!=typeof t.return&&(this.return=void 0)}return"function"==typeof Symbol&&Symbol.asyncIterator&&(t.prototype[Symbol.asyncIterator]=function(){return this}),t.prototype.next=function(e){return this._invoke("next",e)},t.prototype.throw=function(e){return this._invoke("throw",e)},t.prototype.return=function(e){return this._invoke("return",e)},{wrap:function(e){return function(){return new t(e.apply(this,arguments))}},await:function(t){return new e(t)}}}();function ajax(e){return new Promise(function(t,o){"string"==typeof e&&(e={url:e}),e.method||(e.method="post"),e.headers||(e.headers={"Content-type":"application/x-www-form-urlencoded; charset=UTF-8"}),e.headers["Access-Control-Allow-Origin"]||(e.headers["Access-Control-Allow-Origin"]="*"),e.credentials||e.url.startsWith(window.origin)&&(e.credentials="same-origin");var n=e.url||window.location.href;if(e.body){var r="object"==_typeof(e.body)?deepSerialize(e.body):e.body,i=e.method.toLowerCase();"post"===i?"FormData"===e.body.constructor.name?e.headers={}:e.body=r:"get"===i&&(delete e.body,n.includes("?")?n+=n.endsWith("&")||n.endsWith("?")?"":"&":0!==r.indexOf("?")&&(n+="?"),n+=r)}var a=new Request(n,e);fetch(a).then(function(e){var n=e.headers.get("content-type"),r=function(e){return-1!==n.indexOf(e)};e.ok&&n?r("application/json")?t(e.json()):r("text/")?t(e.text()):r("form-data")?t(e.formData()):r("image/")?t(e.blob()):r("audio/")||r("video/")||r("application/ogg")?t(e.arrayBuffer()):t(e):(console.log("ajax response not ok: ",e),o(e))}).catch(function(e){console.log("ajax catch: ",e),o(e)})})}function deepSerialize(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(!e||"function"==typeof e)return""!=t?t+"=null":"";var o=[];if(e instanceof Object){for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];"string"!=typeof r&&"object"!=(void 0===r?"undefined":_typeof(r))||o.push(deepSerialize(r,""!==t?t+"["+n+"]":n))}return o.join("&")}return"string"==typeof e?t+"="+e:void 0}module.exports=ajax;
